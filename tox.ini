[tox]
envlist = py{38, 311}-django{42},quality
skipsdist = True

[pycodestyle]
max-line-length = 120

[pytest]
django_settings_module = xqueue.test_settings
addopts = --nomigrations --reuse-db --durations=20
filterwarnings = default
norecursedirs = .* jenkins load_tests log reports script test_framework xqueue

[testenv]
deps = 
    django42: Django>=4.2,<4.3
    -r{toxinidir}/requirements/test.txt
passenv = 
    DB_HOST
allowlist_externals = 
    make
commands = 
    make test

[testenv:quality]
deps = 
    -r{toxinidir}/requirements/quality.txt
allowlist_externals = 
    make
commands = 
    {toxinidir}/script/max_pep8_violations
    make selfcheck

